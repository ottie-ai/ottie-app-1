# Project Overview
You are an expert Senior Fullstack Engineer working on "Ottie" - a Real Estate Client Portal Generator (SaaS). 
The project uses Next.js 14 (App Router), TypeScript, Supabase, and Tailwind CSS v4.

## üß† CONTEXT ZONES (CRITICAL)
Before writing any code, CHECK THE FILE PATH to determine the context. The app has 3 completely separate styling logics:

### 1. üîµ ADMIN DASHBOARD & UI CHROME
- **Paths:** `/app/(app)/overview/**/*`, `/app/(app)/sites/**/*`, `/app/(app)/settings/**/*`, `/app/(app)/client-portals/**/*`, `/app/(app)/layout.tsx`, `/components/ui/**/*`, `/components/workspace/**/*`, `/components/builder/settings/**/*`
- **Role:** The SaaS interface, Settings, Editor controls (including "Remix Section" buttons and settings panels).
- **Styling:** STRICT Shadcn UI compliance.
- **Theme:** Uses `next-themes`. MUST use semantic classes (`bg-background`, `text-foreground`, `border-input`).
- **Icons:** `lucide-react` ONLY.
- **Forbidden:** Do NOT use hardcoded colors (e.g., `bg-white`). Always verify dark mode compatibility.
- **IMPORTANT:** ONLY this zone has dark/light mode. Builder and Marketing do NOT have theme switching.

### 2. üü¢ TEMPLATE RENDERER (The "Elementor" Part)
- **Paths:** `/app/(builder)/builder/**/*`, `/components/templates/**/*`, `/components/builder/FontLoader.tsx`, `/components/builder/FontTransition.tsx`
- **Note:** 
 - `/components/workspace/SectionEditor.tsx` is ADMIN UI (edit buttons)
 - `/components/builder/settings/**/*` is ADMIN UI (settings panels)
- **Role:** User-generated content (Hero, Gallery, Features).
- **Styling:** ISOLATED component styling.
- **Theme:** Builder has NO dark/light mode. Builder always uses fixed styling (dark luxury theme for admin UI, but site content uses its own `colorScheme`).
- **Site colorScheme:** Sections use `colorScheme` prop (`'light' | 'dark'`) to determine background/text colors - this is about SITE styling, NOT builder theme.
- **Icons:** `@phosphor-icons/react` (Always use `weight="light"`).
- **Rule:** Never apply `bg-background` or global theme classes here. These sections must look identical regardless of the Admin UI theme.

### 3. üü£ MARKETING HOMEPAGE
- **Paths:** `/app/(marketing)/**/*` (includes `/app/(marketing)/page.tsx`, `/app/(marketing)/privacy/page.tsx`, `/app/(marketing)/terms/page.tsx`), `/components/marketing/**/*`
- **Role:** The landing page for the SaaS itself and public pages (Privacy, Terms).
- **Styling:** Custom, hardcoded aesthetic.
- **Theme:** NO ThemeProvider. NO dark/light mode. Hardcoded dark style (`bg-[#08000d]`).

---

## üõ† Tech Stack & Rules

### UI & Tailwind CSS v4
- **Config:** CSS-based configuration in `globals.css` (No `tailwind.config.ts`).
- **Shadcn UI (New York v4):**
  - IF adding a new standard UI component (Button, Dialog), RUN: `npx shadcn@latest add <component_name>`.
  - Do NOT manually create files in `/components/ui`.
  - Do NOT invent custom CSS classes. Use `cn()` for merging.
- **Inline Styles:**
  - **STRICTLY FORBIDDEN:** Never use inline `style={{}}` props unless explicitly requested by the user.
  - Always use Tailwind CSS classes or CSS variables for styling.
  - **Force Light/Dark Mode:** If you need to force light mode on specific components (e.g., floating navbar, morphing indicator), use the `.force-light-mode` CSS class wrapper. This class is defined in `globals.css` and overrides all CSS variables to light mode values. Example:
    ```tsx
    <div className="force-light-mode">
      <Button>Click me</Button>
      <Tabs>...</Tabs>
    </div>
    ```
  - Components should be reusable and styled consistently through their className props, not inline styles.

### Architecture: Section Builder
- **Registry:** All template sections map via `components/templates/registry.ts`.
- **Isolation:** Each section (Hero, Features) must be self-contained in `components/templates/[type]/`.
- **Data Driven:** UI is driven by a JSON `PageConfig` object.

### Components Organization
- **`/components/marketing/`** - Components for marketing/homepage (navbar, etc.)
- **`/components/workspace/`** - Components for workspace/admin UI (sidebar, SectionEditor, pricing-dialog, etc.)
- **`/components/builder/`** - Builder UI tools (FontSelector, FontLoader, FontTransition, settings panels)
- **`/components/templates/`** - Template section components (Hero, Features, Gallery, etc.) and renderer (SectionRenderer, registry)
- **`/components/ui/`** - Shared UI components (Shadcn UI) - used everywhere
- **`/components/theme-provider.tsx`** - Theme provider - used everywhere

### Backend (Supabase)
- **Auth:** Use Supabase Auth.
- **Data:** Use Server Actions for mutations.
- **Types:** Strict TypeScript interfaces for all data props.

## ‚ö°Ô∏è Workflow Rules
1. **New Template Sections:** When asked to create a section (e.g., "Testimonials"), creates it in `components/templates/testimonials/` and register it in the registry. Use **Phosphor Icons**.
2. **New Admin Features:** When asked to create a workspace feature, use **Lucide Icons** and standard Shadcn components. All platform routes are in `/app/(app)/` route group.
3. **Inline Editing:** In the Layout Builder (`/app/(builder)/builder/[id]`), use `EditableText` for text elements to allow inline editing.
4. **Route Groups & URLs:** 
   - `/app/(marketing)/` - Public pages (homepage, privacy, terms) ‚Üí URLs: `/`, `/privacy`, `/terms`
   - `/app/(app)/` - Protected platform routes - requires authentication via `(app)/layout.tsx`
     - `/app/(app)/overview/` - Overview page ‚Üí URL: `/overview`
     - `/app/(app)/sites/` - Sites list page ‚Üí URL: `/sites`
     - `/app/(app)/sites/[id]/` - Site backend (Settings/Analytics/Leads + mini preview) ‚Üí URL: `/sites/[id]`
     - `/app/(builder)/builder/[id]/` - Layout builder (Full-screen editor) ‚Üí URL: `/builder/[id]`
     - `/app/(app)/preview/[id]/` - Preview route (opens in new tab) ‚Üí URL: `/preview/[id]`
     - `/app/(app)/settings/` - Settings page ‚Üí URL: `/settings`
     - `/app/(app)/client-portals/` - Client portals page ‚Üí URL: `/client-portals`
     - `/app/(app)/login/` - Login page ‚Üí URL: `/login`
     - `/app/(app)/signup/` - Signup page ‚Üí URL: `/signup`
   - `/app/(z-sites)/[site]/` - Client subdomain routes ‚Üí URLs: `client.ottie.com/*` (z- prefix ensures lower priority than (app) routes)
